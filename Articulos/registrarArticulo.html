<html>

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.1/css/all.css"
        integrity="sha384-50oBUHEmvpQ+1lW4y57PTFmhCaXp0ML5d60M1M7uH2+nqUivzIebhndOJK28anvf" crossorigin="anonymous">
    <link rel="stylesheet" href="../Inicio/estilos.css">
    <title>Registrar Articulo</title>
</head>

<body>

    <nav class="navbar navbar-expand-lg navbar-light sticky-top">
        <div class="container">
            <a class="navbar-brand" href="../Inicio/index.html">SuperMaMi</a>
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#mobile_nav"
                aria-controls="mobile_nav" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="mobile_nav">
                <ul class="navbar-nav mr-auto mt-2 mt-lg-0 float-md-right">
                </ul>
                <ul class="navbar-nav navbar-light">
                    <li class="nav-item"><a class="nav-link" href="../Inicio/index.html">Inicio</a></li>
                    <li class="nav-item dmenu dropdown">
                        <a class="nav-link dropdown-toggle" href="../Clientes/ListadoClientes.html" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Clientes
                        </a>
                        <div class="dropdown-menu sm-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../Clientes/Registrarclientes.html">Ingresar nuevo
                                Cliente</a>
                            <a class="dropdown-item" href="../Clientes/ListadoClientes.html">Ver Listado de Clientes</a>
                        </div>
                    </li>
                    <li class="nav-item dmenu dropdown">
                        <a class="nav-link dropdown-toggle" href="../Usuarios/ListadoUsuarios.html" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Usuarios
                        </a>
                        <div class="dropdown-menu sm-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../Usuarios/RegistrarUsuario.html">Ingresar nuevo Usuario</a>
                            <a class="dropdown-item" href="../Usuarios/ListadoUsuarios.html">Ver Listado de Usuarios</a>
                        </div>
                    </li>
                    <li class="nav-item dmenu dropdown">
                        <a class="nav-link dropdown-toggle" href="../Pedidos/ListadoPedidos.html" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Pedidos
                        </a>
                        <div class="dropdown-menu sm-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../Pedidos/RegistrarPedidos.html">Ingresar nuevo Pedido</a>
                            <a class="dropdown-item" href="../Pedidos/ListadoPedidos.html">Ver Listado de Pedidos</a>
                        </div>
                    </li>
                    <li class="nav-item dmenu dropdown">
                        <a class="nav-link dropdown-toggle" href="../Articulos/listadoArticulos.html"
                            id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true"
                            aria-expanded="false">
                            Articulos
                        </a>
                        <div class="dropdown-menu sm-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item" href="../Articulos/registrarArticulo.html">Ingresar nuevo
                                Articulo</a>
                            <a class="dropdown-item" href="../Articulos/listadoArticulos.html">Ver Listado de
                                Articulos</a>
                        </div>
                    </li>
                    <li class="nav-item dmenu dropdown">
                        <a class="nav-link dropdown-toggle"
                            href="../Reportes/ArticulosMasVendidos/ReporteArticulosMasVendidos.html" id="navbarDropdown"
                            role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                            Reportes
                        </a>
                        <div class="dropdown-menu sm-menu" aria-labelledby="navbarDropdown">
                            <a class="dropdown-item"
                                href="../Reportes/ArticulosMasVendidos/ReporteArticulosMasVendidos.html">Articulos mas
                                Vendidos</a>
                            <a class="dropdown-item"
                                href="../Reportes/ClienteMasFrecuente/ReporteClienteMasFrecuente.html">Clientes mas
                                Frecuentes</a>
                            <a class="dropdown-item" href="../Articulos/ListadoProductosSinStock.html">Productos sin
                                Stock</a>

                        </div>
                    </li>
                    <li class="nav-item"><a class="nav-link" href="../Inicio/integrantes.html">APD</a></li>
                </ul>
            </div>
        </div>
    </nav>

    <div class="container mt-4 col-lg-6">
        <div class="card col-sm-10">
            <div class="card-body">
                <h3>Registrar Articulo</h3><br>
                <form method="POST" onsubmit="return registro();">


                    <br>

                    <div class="row g-3">
                        <div class="col">
                            <input type="text" class="form-control" placeholder="Producto" id="txtProducto">
                        </div>
                    </div>

                    <br>

                    <div class="row g-3 mx-1">

                        <select class=" form-control" placeholder="proveedor" id="cuerpoCombo">
                            <option selected>Seleccione el Proveedor</option>
                        </select>
                    </div>

                    <br>

                    <div class="row g-3">
                        <div class="col">
                            <input type="text" class="form-control" placeholder="Precio" id="txtPrecio"
                                name="txtPrecio">
                        </div>
                    </div>

                    <br>

                    <div class="row g-3">
                        <div class="col">
                            <input type="text" class="form-control" placeholder="Stock" id="txtStock" name="txtStock">
                        </div>
                    </div>





                    <br>
                    <div class="text-center">
                        <input type="submit" value="Agregar" class="btn btn-info" id="btnAgregar"> </input>&nbsp;&nbsp;
                        <a href="/Inicio/index.html" class="btn btn-success my-2 my-sm-0">Cancelar</a>
                    </div>

                </form>
            </div>
        </div>
    </div>




   

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"
        integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
        crossorigin="anonymous"></script>
    <script src=" https://unpkg.com/sweetalert/dist/sweetalert.min.js "></script>
    <script src="../Inicio/navbar.js"></script>


    <script>
        $(document).ready(function () {

            $.ajax({
                url: "https://localhost:5001/Articulos/ObtenerProveedores",
                type: "GET",
                success: function (result) {
                    if (result.ok) {
                        cargarCombo(result.return);
                    } else {
                        swal(result.error);
                    }
                },
                error: function (error) {
                    console.log(error);
                },
            });

        });

        function cargarCombo(datos) {
            for (var i = 0; i < datos.length; i++) {
                var html = "<option value=\"" + datos[i].id + "\">" + datos[i].nombre + "</option>";
                $("#cuerpoCombo").append(html);
            }
        }

    </script>
    <script>

        function Validar() {

            let txtArticulo = document.getElementById('txtProducto');
            let txtProveedor = document.getElementById('cuerpoCombo');
            let txtPrecio = document.getElementById('txtPrecio');
            let txtStock = document.getElementById('txtStock');
            alert(txtArticulo.value + txtProveedor.value + txtPrecio.value + txtStock.value)


            if (txtArticulo.value === "") {
                alert('Ingrese codigo de articulo');
            }
            if (txtProveedor.value == 0) {
                alert('Ingrese proveedor');
            }
            if (txtPrecio.value === "") {
                alert('Ingrese precio del producto');
            }
            if (txtStock.value === "") {
                alert('Ingrese el stock');
            }
            if (isNaN(txtStock.value)) {
                alert('Ingrese Solo Numeros en el stock');
            }

            else {
                var nombre = txtArticulo.value;
                var stock = txtStock.value;
                var precio = txtPrecio.value;
                var idProveedor = txtProveedor.value;
                alert('datos validados');
                let comando = {
                    "nombre": nombre,
                    "stock": stock,
                    "precio": precio,
                    "idProveedor": idProveedor
                }

                $.ajax({
                    url: "https://localhost:5001/Articulos/AltaArticulos",
                    type: "POST",
                    data: JSON.stringify(comando),
                    dataType: "json",
                    contentType: "application/json",
                    success: function (result) {
                        if (result.ok) {
                            alert("Carga completada", "Se ha agregado el articulo correctamente");
                            setTimeout(function () {
                                window.location.replace("listadoArticulos.html");
                            }, 5000);
                        } else {
                            alert(result.error);
                        }
                    },
                    error: function (error) {
                        console.log(error);
                    }
                });










            }


        }


        let btnAgregar = document.getElementById('btnAgregar');

        btnAgregar.addEventListener("click", Validar);


    </script>

</body>